---
- event_type: compute.instance.*
  traits: &instance_traits
   event_type:
      fields: event_type
    message_id:
      fields: message_id
    timestamp:
      type: datetime
      fields: timestamp
    launched_at:
      type: datetime
      fields: dimensions.payload.launched_at
    deleted_at:
      type: datetime
      fields: dimensions.payload.deleted_at
    hostname:
      fields: dimensions.payload.hostname
    tenant_id:
      fields: dimensions._context_tenant
    user_id:
      fields: dimensions.payload.user_id
    instance_id:
      fields: dimensions.payload.instance_id
    host:
      fields: dimensions.publisher_id
      plugin:
        name: split
        parameters:
          segment: 1
          max_split: 1
    service:
      fields: publisher_id
      plugin: split
    memory_mb:
      type: int
      fields: dimensions.payload.memory_mb
    disk_gb:
      type: int
      fields: dimensions.payload.disk_gb
    root_gb:
      type: int
      fields: dimensions.payload.root_gb
    ephemeral_gb:
      type: int
      fields: dimensions.payload.ephemeral_gb
    vcpus:
      type: int
      fields: dimensions.payload.vcpus
    instance_type_id:
      type: int
      fields: dimensions.payload.instance_type_id
    instance_type:
      fields: dimensions.payload.instance_type
    state:
      fields: dimensions.payload.state
    os_architecture:
      fields: dimensions.payload.image_meta.'org.openstack__1__architecture'
    os_version:
      fields: dimensions.payload.image_meta.'org.openstack__1__os_version'
    os_distro:
      fields: dimensions.payload.image_meta.'org.openstack__1__os_distro'
    launched_at:
      type: datetime
      fields: dimensions.payload.launched_at
    deleted_at:
      type: datetime
      fields: dimensions.payload.deleted_at
- event_type: compute.instance.exists
  traits:
    <<: *instance_traits
    audit_period_beginning:
      type: datetime
      fields: dimensions.payload.audit_period_beginning
    audit_period_ending:
      type: datetime
      fields: dimensions.payload.audit_period_ending

